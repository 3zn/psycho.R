rounded <- round(x, 2)
rounded <- signif(x, 2)
rounded
txt <- function(x){
if (x >= 0){
rounded <- round(x, 2)
} else{
rounded <- signif(x, 2)
}
return(sprintf("%.2f", rounded))
}
text <- paste("Based on the observed data, there is a probability of ", txt(MDP), "% that the coefficient is between ", txt(MDP_values[1]), " and ", txt(MDP_values[2]), " (Median = ", txt(median), ", MAD = ", txt(mad), ", Mean = ", txt(mean), ", SD = ", txt(sd), ", ", CI, "% CI [", txt(CI_values[1]), ", ", txt(CI_values[2]), "]).", sep="")
text
txt <- function(x){
if (x >= 0){
rounded <- round(x, 2)
} else{
rounded <- signif(x, 2)
}
return(rounded)
# return(sprintf("%.2f", rounded))
}
text <- paste("Based on the observed data, there is a probability of ", txt(MDP), "% that the coefficient is between ", txt(MDP_values[1]), " and ", txt(MDP_values[2]), " (Median = ", txt(median), ", MAD = ", txt(mad), ", Mean = ", txt(mean), ", SD = ", txt(sd), ", ", CI, "% CI [", txt(CI_values[1]), ", ", txt(CI_values[2]), "]).", sep="")
text
MDP_values[1]
txt <- function(x){
if (abs(x) < 1){
rounded <- signif(x, 2)
} else{
rounded <- round(x, 2)
}
return(rounded)
# return(sprintf("%.2f", rounded))
}
text <- paste("Based on the observed data, there is a probability of ", txt(MDP), "% that the coefficient is between ", txt(MDP_values[1]), " and ", txt(MDP_values[2]), " (Median = ", txt(median), ", MAD = ", txt(mad), ", Mean = ", txt(mean), ", SD = ", txt(sd), ", ", CI, "% CI [", txt(CI_values[1]), ", ", txt(CI_values[2]), "]).", sep="")
text
txt <- function(x, digits=2, null_treshold=0.0001){
if (abs(x) < 1){
rounded <- signif(x, digits)
} else{
rounded <- round(x, digits)
}
if (abs(rounded) < null_treshold){
rounded = "0"
}
return(rounded)
# return(sprintf("%.2f", rounded))
}
text <- paste("Based on the observed data, there is a probability of ", txt(MDP), "% that the coefficient is between ", txt(MDP_values[1]), " and ", txt(MDP_values[2]), " (Median = ", txt(median), ", MAD = ", txt(mad), ", Mean = ", txt(mean), ", SD = ", txt(sd), ", ", CI, "% CI [", txt(CI_values[1]), ", ", txt(CI_values[2]), "]).", sep="")
text
txt <- function(x, digits=2, null_treshold=0.001){
if (abs(x) < 1){
rounded <- signif(x, digits)
} else{
rounded <- round(x, digits)
}
if (abs(rounded) < null_treshold){
rounded <- "0"
}
return(rounded)
# return(sprintf("%.2f", rounded))
}
text <- paste("Based on the observed data, there is a probability of ", txt(MDP), "% that the coefficient is between ", txt(MDP_values[1]), " and ", txt(MDP_values[2]), " (Median = ", txt(median), ", MAD = ", txt(mad), ", Mean = ", txt(mean), ", SD = ", txt(sd), ", ", CI, "% CI [", txt(CI_values[1]), ", ", txt(CI_values[2]), "]).", sep="")
text
text <- paste("Concerning the effect of ", varname, ", there is a probability of ", txt(MDP), "% that the coefficient is between ", txt(MDP_values[1]), " and ", txt(MDP_values[2]), " (Median = ", txt(median), ", MAD = ", txt(mad), ", Mean = ", txt(mean), ", SD = ", txt(sd), ", ", CI, "% CI [", txt(CI_values[1]), ", ", txt(CI_values[2]), "]).", sep="")
text
format_digit <- function(x, digits=2, null_treshold=0.001){
if (abs(x) < 1){
rounded <- signif(x, digits)
} else{
rounded <- round(x, digits)
}
if (abs(rounded) < null_treshold){
rounded <- "0"
}
return(rounded)
}
text <- paste("Concerning the effect of ", varname, ", there is a probability of ", format_digit(MDP), "% that the coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
text
strsplit(varname, ":")
varname <- "dupa"
strsplit(varname, ":")
length(varname)
varname <- "mpg:cyl"
varname <- strsplit(varname, ":")
length(varname)
varname
varname <- "mpg:cyl"
varname <- strsplit(varname, ":")[1]
length(varname)
varname
varname <- "mpg:cyl"
varname <- strsplit(varname, ":")
varname
varname <- "mpg:cyl"
strsplit(varname, ":")[1]
varname <- "mpg:cyl"
strsplit(varname, ":")[[1]]
varname <- strsplit(varname, ":")[[1]]
length(varname)
varname <- "dupa"
varname <- strsplit(varname, ":")[[1]]
length(varname)
varname <- "dupa"
# varname <- "mpg:cyl"
varname <- strsplit(varname, ":")[[1]]
if (length(varname)==1){
varname <- paste("effect of ", varname)
}
text <- paste("Concerning the effect of ", varname, ", there is a probability of ", format_digit(MDP), "% that the coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
text
varname <- "dupa"
# varname <- "mpg:cyl"
varname <- strsplit(varname, ":")[[1]]
if (length(varname)==1){
varname <- paste("effect of ", varname, sep="")
}
text <- paste("Concerning the effect of ", varname, ", there is a probability of ", format_digit(MDP), "% that the coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
text
varname <- "mpg:cyl"
varname <- strsplit(varname, ":")[[1]]
text <- paste("Concerning the effect of ", varname, ", there is a probability of ", format_digit(MDP), "% that the coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
text
varname <- "mpg:cyl"
":" %in% varname
grepl(":", varname)
varname <- "dupa"
# varname <- "mpg:cyl"
if (grepl(":", varname))
splitted <- strsplit(varname, ":")[[1]]
if (length(varname)==2){
varname <- paste("interaction effect between ", varname[1], " and ", varname[2], sep="")
} else{
varname <- paste("effect of ", varname, sep="")
}
text <- paste("Concerning the effect of ", varname, ", there is a probability of ", format_digit(MDP), "% that the coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
text
varname <- "mpg:cyl"
if (grepl(":", varname))
splitted <- strsplit(varname, ":")[[1]]
if (length(varname)==2){
varname <- paste("interaction effect between ", varname[1], " and ", varname[2], sep="")
} else{
varname <- paste("effect of ", varname, sep="")
}
text <- paste("Concerning the effect of ", varname, ", there is a probability of ", format_digit(MDP), "% that the coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
text
varname <- "mpg:cyl"
if (grepl(":", varname))
splitted <- strsplit(varname, ":")[[1]]
if (length(varname)==2){
varname <- paste("interaction effect between ", varname[1], " and ", varname[2], sep="")
}} else{
varname <- paste("effect of ", varname, sep="")
}
text <- paste("Concerning the effect of ", varname, ", there is a probability of ", format_digit(MDP), "% that the coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
text
varname <- "mpg:cyl"
if (grepl(":", varname))
splitted <- strsplit(varname, ":")[[1]]
if (length(splitted)==2){
splitted <- paste("interaction effect between ", splitted[1], " and ", splitted[2], sep="")
}} else{
varname <- paste("effect of ", varname, sep="")
}
text <- paste("Concerning the effect of ", varname, ", there is a probability of ", format_digit(MDP), "% that the coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
text
varname <- "mpg:cyl"
grepl(":", varname)
splitted <- strsplit(varname, ":")[[1]]
splitted
length(splitted)
splitted[1]
varname <- "mpg:cyl"
if (grepl(":", varname)){
splitted <- strsplit(varname, ":")[[1]]
if (length(splitted)==2){
varname <- paste("interaction effect between ", splitted[1], " and ", splitted[2], sep="")
}
} else{
varname <- paste("effect of ", varname, sep="")
}
text <- paste("Concerning the effect of ", varname, ", there is a probability of ", format_digit(MDP), "% that the coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
text
varname <- "mpg:cyl"
if (grepl(":", varname)){
splitted <- strsplit(varname, ":")[[1]]
if (length(splitted)==2){
varname <- paste("interaction effect between ", splitted[1], " and ", splitted[2], sep="")
}
} else{
varname <- paste("effect of ", varname, sep="")
}
text <- paste("Concerning the ", varname, ", there is a probability of ", format_digit(MDP), "% that the coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
text
varname <- "dupa"
# varname <- "mpg:cyl"
if (grepl(":", varname)){
splitted <- strsplit(varname, ":")[[1]]
if (length(splitted)==2){
varname <- paste("interaction effect between ", splitted[1], " and ", splitted[2], sep="")
}
} else{
varname <- paste("effect of ", varname, sep="")
}
text <- paste("Concerning the ", varname, ", there is a probability of ", format_digit(MDP), "% that its coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
text
posteriors <- as.data.frame(fit)
# Initialize empty values
values <- list()
# Loop over all variables
for (varname in names(posteriors)){
# Extract posterior
posterior <- posteriors[, varname]
# Find basic posterior indices
median=median(posterior)
mad=mad(posterior)
mean <- mean(posterior)
sd <- sd(posterior)
CI_values <- quantile(posterior, c((100-CI)/2/100, 1-(100-CI)/2/100))
# Compute MDP
for (MDP in seq(0, 100, by = MDP_step)){
MDP_values <- 100-MDP
MDP_values <- quantile(posterior, c(0+MDP_values/2/100, 1-MDP_values/2/100))
if (median >= 0){
if (MDP_values[1] <= MDP_min){
break
}
} else {
if (MDP_values[2] >= -MDP_min){
break
}
}
}
# Create text
if (grepl(":", varname)){
splitted <- strsplit(varname, ":")[[1]]
if (length(splitted)==2){
varname <- paste("interaction effect between ", splitted[1], " and ", splitted[2], sep="")
}
} else{
varname <- paste("effect of ", varname, sep="")
}
text <- paste("Concerning the ", varname, ", there is a probability of ", format_digit(MDP), "% that its coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
# Store all that
values[[varname]] <- list(median=median,
mad=mad,
mean=mean,
sd=sd,
CI_values=CI_values,
MDP=MDP,
MDP_values=MDP_values,
posterior=posterior,
text=text)
}
# Values
# -------------
text <- list()
for (varname in names(values)){
print(values[varname]$text)
}
values
posteriors <- as.data.frame(fit)
# Initialize empty values
values <- list()
# Loop over all variables
for (varname in names(posteriors)){
# Extract posterior
posterior <- posteriors[, varname]
# Find basic posterior indices
median=median(posterior)
mad=mad(posterior)
mean <- mean(posterior)
sd <- sd(posterior)
CI_values <- quantile(posterior, c((100-CI)/2/100, 1-(100-CI)/2/100))
# Compute MDP
for (MDP in seq(0, 100, by = MDP_step)){
MDP_values <- 100-MDP
MDP_values <- quantile(posterior, c(0+MDP_values/2/100, 1-MDP_values/2/100))
if (median >= 0){
if (MDP_values[1] <= MDP_min){
break
}
} else {
if (MDP_values[2] >= -MDP_min){
break
}
}
}
# Create text
if (grepl(":", varname)){
splitted <- strsplit(varname, ":")[[1]]
if (length(splitted)==2){
name <- paste("interaction effect between ", splitted[1], " and ", splitted[2], sep="")
} else{
name <- varname
}
} else{
name <- paste("effect of ", varname, sep="")
}
text <- paste("Concerning the ", name, ", there is a probability of ", format_digit(MDP), "% that its coefficient is between ", format_digit(MDP_values[1]), " and ", format_digit(MDP_values[2]), " (Median = ", format_digit(median), ", MAD = ", format_digit(mad), ", Mean = ", format_digit(mean), ", SD = ", format_digit(sd), ", ", CI, "% CI [", format_digit(CI_values[1]), ", ", format_digit(CI_values[2]), "]).", sep="")
# Store all that
values[[varname]] <- list(median=median,
mad=mad,
mean=mean,
sd=sd,
CI_values=CI_values,
MDP=MDP,
MDP_values=MDP_values,
posterior=posterior,
text=text)
}
text <- list()
for (varname in names(values)){
print(values[varname]$text)
}
values$mpg$text
values$`mpg:cyl`$text
plot <- plot(fit)
plot
text <- list()
for (varname in names(values)){
print(values[varname]$text)
}
varname
values[varname]
print(values[varname]$text)
print(values[[varname]]$text)
text <- list()
for (varname in names(values)){
print(values[[varname]]$text)
}
text <- c()
for (varname in names(values)){
text <- c(text, values[[varname]]$text)
}
text
means <- c()
for (varname in names(values)){
means <- c(means, values[[varname]]$mean)
}
means
summary <- data.frame(Variable=names(values), Mean=means)
View(summary)
MDPs <- c()
for (varname in names(values)){
MDPs <- c(MDPs, values[[varname]]$MDP)
}
medians <- c()
for (varname in names(values)){
medians <- c(medians, values[[varname]]$median)
}
mads <- c()
for (varname in names(values)){
mads <- c(mads, values[[varname]]$mad)
}
means <- c()
for (varname in names(values)){
means <- c(means, values[[varname]]$mean)
}
sds <- c()
for (varname in names(values)){
sds <- c(sds, values[[varname]]$sd)
}
summary <- data.frame(Variable=names(values), MDP=MDPs, Median=medians, MAD=mads, Mean=means, SD=sds)
summary
MDPs <- c()
for (varname in names(values)){
MDPs <- c(MDPs, values[[varname]]$MDP)
}
medians <- c()
for (varname in names(values)){
medians <- c(medians, values[[varname]]$median)
}
mads <- c()
for (varname in names(values)){
mads <- c(mads, values[[varname]]$mad)
}
means <- c()
for (varname in names(values)){
means <- c(means, values[[varname]]$mean)
}
sds <- c()
for (varname in names(values)){
sds <- c(sds, values[[varname]]$sd)
}
CIs <- c()
for (varname in names(values)){
CIs <- c(CIs, values[[varname]]$CI_values)
}
CI_values
summary <- data.frame(Variable=names(values), MDP=MDPs, Median=medians, MAD=mads, Mean=means, SD=sds, CI=CIs)
summary
CIs
CIs[1]
CIs[,1]
CIs[1,]
CIs[seq(1, length(CIs), 2]
CIs[seq(1, length(CIs), 2)]
CIs[seq(2, length(CIs), 2)]
MDPs <- c()
for (varname in names(values)){
MDPs <- c(MDPs, values[[varname]]$MDP)
}
medians <- c()
for (varname in names(values)){
medians <- c(medians, values[[varname]]$median)
}
mads <- c()
for (varname in names(values)){
mads <- c(mads, values[[varname]]$mad)
}
means <- c()
for (varname in names(values)){
means <- c(means, values[[varname]]$mean)
}
sds <- c()
for (varname in names(values)){
sds <- c(sds, values[[varname]]$sd)
}
CIs <- c()
for (varname in names(values)){
CIs <- c(CIs, values[[varname]]$CI_values)
}
summary <- data.frame(Variable=names(values), MDP=MDPs, Median=medians, MAD=mads, Mean=means, SD=sds, CI_lower=CIs[seq(1, length(CIs), 2)], CI_higher=CIs[seq(2, length(CIs), 2)])
summary
rstanarm::prior_summary(fit)
summary(fit)
priors <- rstanarm::prior_summary(fit)
priors
priors$prior
fit$formula
fit$terms
fit$y
summ <- summary(fit)
summ
info <- paste("We fitted a Markov Chain Monte Carlo [type] model to predict [Y] with [X] (", fit$terms, "", sep="")
info <- paste("We fitted a Markov Chain Monte Carlo [type] model to predict [Y] with [X] (", fit$terms, ").", sep="")
# Priors
priors <- rstanarm::prior_summary(fit)
# Coefs
coefs_text <- c()
for (varname in names(values)){
coefs_text <- c(coefs_text, values[[varname]]$text)
}
text <- c(info, priors, coefs_text)
text
priors <- rstanarm::prior_summary(fit)
# Coefs
coefs_text <- c()
for (varname in names(values)){
coefs_text <- c(coefs_text, values[[varname]]$text)
}
text <- c(priors, coefs_text)
text
info <- paste("We fitted a Markov Chain Monte Carlo [type] model to predict [Y] with [X] (", fit$terms, ").", sep="")
# Priors
priors <- rstanarm::prior_summary(fit)
# Coefs
coefs_text <- c()
for (varname in names(values)){
coefs_text <- c(coefs_text, values[[varname]]$text)
}
text <- c(info, coefs_text)
text
fit$terms
info <- paste("We fitted a Markov Chain Monte Carlo [type] model to predict [Y] with [X] (", fit$formula, ").", sep="")
# Priors
priors <- rstanarm::prior_summary(fit)
# Coefs
coefs_text <- c()
for (varname in names(values)){
coefs_text <- c(coefs_text, values[[varname]]$text)
}
text <- c(info, coefs_text)
text
fit$formula
paste("We fitted a Markov Chain Monte Carlo [type] model to predict [Y] with [X] (", fit$formula, ").", sep="")
paste("We fitted a Markov Chain Monte Carlo [type] model to predict [Y] with [X] (", unlist(fit$formula), ").", sep="")
paste("We fitted a Markov Chain Monte Carlo [type] model to predict [Y] with [X] (", paste(fit$formula), ").", sep="")
paste(fit$formula)
fit$formula
formula <- fit$formula
formula
paste("We fitted a Markov Chain Monte Carlo [type] model to predict [Y] with [X] (", deparse(fit$formula), ").", sep="")
info <- paste("We fitted a Markov Chain Monte Carlo [type] model to predict [Y] with [X] (formula =", deparse(fit$formula), ").", sep="")
# Priors
priors <- rstanarm::prior_summary(fit)
# Coefs
coefs_text <- c()
for (varname in names(values)){
coefs_text <- c(coefs_text, values[[varname]]$text)
}
text <- c(info, priors, coefs_text)
text
priors <- rstanarm::prior_summary(fit)
deparse(priors)
info <- paste("We fitted a Markov Chain Monte Carlo [type] model to predict [Y] with [X] (formula =", deparse(fit$formula), ").", sep="")
# Priors
priors <- rstanarm::prior_summary(fit)
# Coefs
coefs_text <- c()
for (varname in names(values)){
coefs_text <- c(coefs_text, values[[varname]]$text)
}
text <- c(info, deparse(priors), coefs_text)
text
priors
as.character(priors)
print(priors)
paste(print(priors))
paste(priors)
